<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=11"/>
<meta name="generator" content="Doxygen 1.13.0"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>EDS API: Sending live point values</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script type="text/javascript" src="clipboard.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="cookie.js"></script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr id="projectrow">
  <td id="projectlogo"><img alt="Logo" src="logo.png"/></td>
  <td id="projectalign">
   <div id="projectname">EDS API
   </div>
   <div id="projectbrief">Enterprise Data Server Application Programming Interface</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.13.0 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
var searchBox = new SearchBox("searchBox", "search/",'.html');
/* @license-end */
</script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() { codefold.init(0); });
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function() {
  initMenu('',true,false,'search.php','Search',true);
  $(function() { init_search(); });
});
/* @license-end */
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){initNavTree('live_writes.html',''); initResizable(true); });
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<div id="MSearchResults">
<div class="SRPage">
<div id="SRIndex">
<div id="SRResults"></div>
<div class="SRStatus" id="Loading">Loading...</div>
<div class="SRStatus" id="Searching">Searching...</div>
<div class="SRStatus" id="NoMatches">No Matches</div>
</div>
</div>
</div>
</div>

<div><div class="header">
  <div class="headertitle"><div class="title">Sending live point values</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="output_sync"></a>
Synchronizing written point values</h1>
<p>In order to send point values, live client must be initialized with <code>AccessMode_Write</code> or <code>AccessMode_ReadWrite</code> argument.</p>
<p>Applications using a live client to send point values must also regularly (optimally once per second) call its <a class="el" href="classeds_1_1live_1_1_live_client.html#ad4419303b3afacf1503d06257f3a89f9">eds::live::LiveClient::synchronizeOutput</a> method. If an application fails to periodically synchronize output values with EDS Server, the process points it was trying to write will eventually be marked as timed out.</p>
<p>Before a client can start sending values to any process point, it must first register itself as the source of values for that point. Only one client can send value updates for the point at any time.</p>
<p>To notify Online Server that the client wants to send point values, call <a class="el" href="classeds_1_1live_1_1_live_client.html#a4faa3daaa17de6d00f0cc637227a55f6">eds::live::LiveClient::setOutput</a>. The function expects a local point identifier. See <a class="el" href="point_ids.html">Process point identifiers</a> for more information on the subject.</p>
<p>Note that the same client cannot simultaneously be a receiver and sender of values for the same point (i.e. calling <a class="el" href="classeds_1_1live_1_1_live_client.html#ab7ee847fd40c4f16cf4e4aac5a64b4f0">eds::live::LiveClient::setInput</a> with the same <code>LID</code> would be an error).</p>
<p>To assign a new value and quality to a process point, use any of the <a class="el" href="classeds_1_1live_1_1_live_client.html#aaba33c7cb740b83c248fba1ce7c9c88e">eds::live::LiveClient::write</a> methods. It is recommended to choose the method overload which matches the point's type. Otherwise the written value will be automatically converted to appropriate type.</p>
<p>If an application is no longer interested in sending point values, it should call <a class="el" href="classeds_1_1live_1_1_live_client.html#a247c64ca2a45be391f20e31559163b33">eds::live::LiveClient::unsetOutput</a>.</p>
<h1><a class="anchor" id="live_write_example"></a>
Example</h1>
<p>Some details are omitted from this example. See <a class="el" href="_live_client_8cpp-example.html">LiveClient.cpp</a> for a complete implementation.</p>
<div class="fragment"><div class="line"><span class="keywordtype">bool</span> originatePoint(LiveClient* client, <span class="keyword">const</span> <span class="keywordtype">char</span>* pointName)</div>
<div class="line">{</div>
<div class="line">  <span class="keywordflow">try</span></div>
<div class="line">  {</div>
<div class="line">    <span class="comment">// Get lid (local id) of point by it&#39;s IESS.</span></div>
<div class="line">    <span class="keywordtype">int</span> lid = client-&gt;findByIESS(pointName);</div>
<div class="line">    <span class="keywordflow">if</span> (lid == -1)</div>
<div class="line">    {</div>
<div class="line">      printf(<span class="stringliteral">&quot;Couldn&#39;t find point with IESS &#39;%s&#39;\n&quot;</span>, pointName);</div>
<div class="line">      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Become the source of values for the point.</span></div>
<div class="line">    client-&gt;setOutput(lid);</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">catch</span> (<span class="keyword">const</span> Error&amp; exc)</div>
<div class="line">  {</div>
<div class="line">    printf(<span class="stringliteral">&quot;Failed to originate point &#39;%s&#39; (%s)\n&quot;</span>, pointName, exc.what());</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> writePoint(LiveClient* client, <span class="keyword">const</span> <span class="keywordtype">char</span>* pointName, <span class="keywordtype">float</span> value)</div>
<div class="line">{</div>
<div class="line">  <span class="keywordflow">try</span></div>
<div class="line">  {</div>
<div class="line">    <span class="comment">// Get the point&#39;s local identifier from IESS.</span></div>
<div class="line">    <span class="keywordtype">int</span> lid = client-&gt;findByIESS(pointName);</div>
<div class="line">    <span class="keywordflow">if</span> (lid == -1)</div>
<div class="line">    {</div>
<div class="line">      printf(<span class="stringliteral">&quot;Couldn&#39;t find point with IESS &#39;%s&#39;\n&quot;</span>, pointName);</div>
<div class="line">      <span class="keywordflow">return</span>;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Schedule an update of point value.</span></div>
<div class="line">    client-&gt;write(lid, value, eds::Quality_Good);</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">catch</span> (<span class="keyword">const</span> Error&amp; exc)</div>
<div class="line">  {</div>
<div class="line">    printf(</div>
<div class="line">      <span class="stringliteral">&quot;Failed to write value of point &#39;%s&#39; (%s)\n&quot;</span>,</div>
<div class="line">      pointName,</div>
<div class="line">      exc.what());</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">void</span> uploadPointValues(LiveClient* client)</div>
<div class="line">{</div>
<div class="line">  <span class="keywordflow">try</span></div>
<div class="line">  {</div>
<div class="line">    client-&gt;synchronizeOutput();</div>
<div class="line">  }</div>
<div class="line">  <span class="keywordflow">catch</span> (<span class="keyword">const</span> Error&amp; exc)</div>
<div class="line">  {</div>
<div class="line">     <span class="comment">// Client might be disconnected.</span></div>
<div class="line">    printf(<span class="stringliteral">&quot;Failed to synchronize output point values (%s)\n&quot;</span>, exc.what());</div>
<div class="line">  }</div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="keywordtype">int</span> main()</div>
<div class="line">{</div>
<div class="line">  <span class="comment">// Details of client initialization are omitted for brevity.</span></div>
<div class="line">  std::unique_ptr&lt;LiveClient&gt; client = initializeClient();</div>
<div class="line"> </div>
<div class="line">  <span class="comment">// Points have to be originated to send value updates to server.</span></div>
<div class="line">  <span class="keywordflow">if</span> (!originatePoint(client.get(), <span class="stringliteral">&quot;PointX&quot;</span>) || !originatePoint(client.get(), <span class="stringliteral">&quot;PointY&quot;</span>))</div>
<div class="line">    <span class="keywordflow">return</span> 1;</div>
<div class="line"> </div>
<div class="line">  <span class="keywordflow">while</span> (<span class="keyword">true</span>)</div>
<div class="line">  {</div>
<div class="line">    writePoint(client.get(), <span class="stringliteral">&quot;PointX&quot;</span>, <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>(rand()));</div>
<div class="line">    writePoint(client.get(), <span class="stringliteral">&quot;PointY&quot;</span>, <span class="keyword">static_cast&lt;</span><span class="keywordtype">float</span><span class="keyword">&gt;</span>(rand()));</div>
<div class="line">    uploadPointValues(client.get());</div>
<div class="line">    std::this_thread::sleep_for(1s);</div>
<div class="line">  }</div>
<div class="line">}</div>
</div><!-- fragment --> </div></div><!-- contents -->
</div><!-- PageDoc -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="index.html">EDS API</a></li><li class="navelem"><a class="el" href="tutorial.html">Tutorial</a></li>
    <li class="footer">Generated on Tue Dec 17 2024 18:16:15 for EDS API by <a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg" width="104" height="31" alt="doxygen"/></a> 1.13.0 </li>
  </ul>
</div>
</body>
</html>
